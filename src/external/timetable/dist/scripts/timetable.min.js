var Bu=Bee.Utils,Ba=Bee.Array,Bo=Bee.Object;function Timetable(){this.scope={hourStart:9,hourEnd:17};this.locations=[];this.events=[]}Timetable.Renderer=function(f){if(!(f instanceof Timetable))throw Error("Initialize renderer using a Timetable");this.timetable=f};
(function(){function f(a){return a===parseInt(a,10)&&0<=a&&24>a}function q(a,b){return b>=a?b-a:24+b-a}function n(a){for(;a.firstChild;)a.removeChild(a.firstChild)}Timetable.prototype={setScope:function(a,b){if(f(a)&&f(b))this.scope.hourStart=a,this.scope.hourEnd=b;else throw new RangeError("Timetable scope should consist of (start, end) in whole hours from 0 to 23");return this},addLocations:function(a){var b=this.locations;if(Bu.isArray(a))Ba.forEach(a,function(a){-1===b.indexOf(a)&&b.push(a)});
else if(Bu.isObject(a))Bo.forEach(a,function(a){-1===b.indexOf(a)&&b.push(a)});else throw Error("Wrong Locations format");return this},addEvent:function(a,b,m,d,r){this.locations.indexOf(b);if(!(m instanceof Date&&d instanceof Date&&m<d))throw Error("Invalid time range: "+JSON.stringify([m,d]));var g="[object Object]"===Object.prototype.toString.call(r);this.events.push({name:a,location:b,startDate:m,endDate:d,options:g?r:void 0});return this}};Timetable.Renderer.prototype={draw:function(a){var b=
this.timetable,m=q(b.scope.hourStart,b.scope.hourEnd);a=document.querySelector(a);if(null===a)throw Error("Timetable container not found");n(a);(function(a){a=a.appendChild(document.createElement("aside")).appendChild(document.createElement("ul"));for(var d=0;d<b.locations.length;d++){var g=a.appendChild(document.createElement("li")).appendChild(document.createElement("span"));g.className="row-heading";g.textContent=b.locations[d]}})(a);(function(a){a=a.appendChild(document.createElement("section")).appendChild(document.createElement("time"));
for(var d=a.appendChild(document.createElement("header")).appendChild(document.createElement("ul")),g=!1,f=!1,h=b.scope.hourStart;!g;){var c=d.appendChild(document.createElement("li")).appendChild(document.createElement("span"));c.className="time-label";c.textContent=(10>h?"0":"")+h+":00";h!==b.scope.hourEnd||b.scope.hourStart===b.scope.hourEnd&&!f||(g=!0);24===++h&&(h=0,f=!0)}a=a.appendChild(document.createElement("ul"));a.className="room-timeline";for(d=0;d<b.locations.length;d++)for(f=a.appendChild(document.createElement("li")),
g=b.locations[d],h=0;h<b.events.length;h++)if(c=b.events[h],c.location===g){var k=void 0,e=void 0,p=void 0,t=!1;void 0!==c.options&&(p=void 0!==c.options.url?!0:!1,e=void 0!==c.options.class?!0:!1,t=void 0!==c.options.data?!0:!1);var l=f.appendChild(document.createElement(p?"a":"span")),n=l.appendChild(document.createElement("small"));l.title=c.name;p&&(l.href=c.options.url);if(t)for(k in c.options.data)l.setAttribute("data-"+k,c.options.data[k]);l.className=e?"time-entry "+c.options.class:"time-entry";
k=l.style;e=c.startDate;e=(c.endDate.getTime()-e.getTime())/1E3/60/60/m*100+"%";k.width=e;l=l.style;e=c;k=b.scope.hourStart;e=e.startDate.getHours()+e.startDate.getMinutes()/60;k=q(k,e)/m*100+"%";l.left=k;n.textContent=c.name}})(a)}}})();
