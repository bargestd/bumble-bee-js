var gulp=require("gulp"),$=require("gulp-load-plugins")(),browserSync=require("browser-sync"),reload=browserSync.reload;gulp.task("styles",function(){return gulp.src("app/styles/*.sass").pipe($.sourcemaps.init()).pipe($.sass({outputStyle:"nested",indentedSyntax:!0,precision:10,includePaths:[".","bower_components"],onError:console.error.bind(console,"Sass error:")})).pipe($.postcss([require("autoprefixer-core")({browsers:["last 1 version"]})])).pipe($.sourcemaps.write()).pipe(gulp.dest(".tmp/styles")).pipe(reload({stream:!0}))});
gulp.task("jshint",function(){return gulp.src("app/scripts/**/*.js").pipe(reload({stream:!0,once:!0})).pipe($.jshint()).pipe($.jshint.reporter("jshint-stylish")).pipe($.if(!browserSync.active,$.jshint.reporter("fail")))});gulp.task("html",["styles"],function(){var a=$.useref.assets({searchPath:[".tmp","app","."]});return gulp.src("app/*.html").pipe(a).pipe($.if("*.css",$.csso())).pipe(a.restore()).pipe($.useref()).pipe(gulp.dest("dist"))});gulp.task("scripts",function(){return gulp.src("app/scripts/plugin.js").pipe($.uglify()).pipe($.rename("timetable.min.js")).pipe(gulp.dest("dist/scripts"))});
gulp.task("images",function(){return gulp.src("app/images/**/*").pipe($.cache($.imagemin({progressive:!0,interlaced:!0,svgoPlugins:[{cleanupIDs:!1}]}))).pipe(gulp.dest("dist/images"))});gulp.task("fonts",function(){return gulp.src(require("main-bower-files")({filter:"**/*.{eot,svg,ttf,woff,woff2}"}).concat("app/fonts/**/*")).pipe(gulp.dest(".tmp/fonts")).pipe(gulp.dest("dist/fonts"))});gulp.task("extras",function(){return gulp.src(["app/*.*","!app/*.html"],{dot:!0}).pipe(gulp.dest("dist"))});
gulp.task("clean",require("del").bind(null,[".tmp","dist"]));gulp.task("serve",["styles","fonts"],function(){browserSync({notify:!1,port:9E3,server:{baseDir:[".tmp","app"],routes:{"/bower_components":"bower_components"}}});gulp.watch(["app/*.html","app/scripts/**/*.js","app/images/**/*",".tmp/fonts/**/*"]).on("change",reload);gulp.watch("app/styles/**/*.sass",["styles"]);gulp.watch("app/fonts/**/*",["fonts"]);gulp.watch("bower.json",["wiredep","fonts"])});
gulp.task("wiredep",function(){var a=require("wiredep").stream;gulp.src("app/styles/*.sass").pipe(a({ignorePath:/^(\.\.\/)+/})).pipe(gulp.dest("app/styles"));gulp.src("app/*.html").pipe(a({ignorePath:/^(\.\.\/)*\.\./})).pipe(gulp.dest("app"))});gulp.task("build","jshint html scripts images fonts extras".split(" "),function(){return gulp.src("dist/**/*").pipe($.size({title:"build",gzip:!0}))});gulp.task("default",["clean"],function(){gulp.start("build")});
